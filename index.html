<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>Infinity Storm - Marvel Slot Game</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>âš¡</text></svg>'">
    <style>
        :root {
            --safe-left: env(safe-area-inset-left, 0px);
            --safe-right: env(safe-area-inset-right, 0px);
            --safe-top: env(safe-area-inset-top, 0px);
            --safe-bottom: env(safe-area-inset-bottom, 0px);
        }
        html, body {
            height: 100%;
        }
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            background-color: #000;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }
        /* In landscape, respect notches by padding left/right only. Never pad top/bottom. */
        @media (orientation: landscape) {
            body {
                padding-left: var(--safe-left);
                padding-right: var(--safe-right);
                padding-top: 0;
                padding-bottom: 0;
            }
        }
        #game-container {
            width: 100vw;
            height: 100dvh;
            max-width: 100vw;
            max-height: 100dvh;
        }
        
        /* Orientation Overlay for mobile devices */
        #orientation-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100dvh;
            background-color: rgba(0, 0, 0, 0.95);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
        }
        
        #orientation-overlay.visible {
            opacity: 1;
        }
        
        .rotate-icon {
            width: 80px;
            height: 80px;
            margin-bottom: 20px;
            animation: rotate-phone 2s infinite linear;
            fill: #ffffff;
        }
        
        @keyframes rotate-phone {
            0% { transform: rotate(0deg); }
            25% { transform: rotate(-90deg); }
            50% { transform: rotate(-90deg); }
            75% { transform: rotate(0deg); }
            100% { transform: rotate(0deg); }
        }
        
        .orientation-text {
            color: #ffffff;
            font-family: Arial, sans-serif;
            font-size: 18px;
            text-align: center;
            max-width: 300px;
            line-height: 1.4;
        }
        
        .orientation-subtitle {
            color: #cccccc;
            font-family: Arial, sans-serif;
            font-size: 14px;
            text-align: center;
            margin-top: 10px;
            max-width: 280px;
        }
        
        /* Responsive sizing for smaller screens */
        @media (max-width: 480px) {
            .rotate-icon {
                width: 60px;
                height: 60px;
            }
            
            .orientation-text {
                font-size: 16px;
                max-width: 280px;
            }
            
            .orientation-subtitle {
                font-size: 12px;
                max-width: 260px;
            }
        }
    </style>
</head>
<body>
    <div id="game-container"></div>
    
    <!-- Orientation Overlay for mobile devices -->
    <div id="orientation-overlay">
        <svg class="rotate-icon" viewBox="0 0 24 24">
            <path d="M16,1H8A3,3 0 0,0 5,4V20A3,3 0 0,0 8,23H16A3,3 0 0,0 19,20V4A3,3 0 0,0 16,1M16,21H8A1,1 0 0,1 7,20V4A1,1 0 0,1 8,3H16A1,1 0 0,1 17,4V20A1,1 0 0,1 16,21M12,18A1,1 0 0,0 13,17A1,1 0 0,0 12,16A1,1 0 0,0 11,17A1,1 0 0,0 12,18Z"/>
        </svg>
        <div class="orientation-text">
            Please rotate your device to landscape
        </div>
        <div class="orientation-subtitle">
            Turn your device sideways for the best gaming experience
        </div>
    </div>
    <script>
        (function () {
            try {
                // Force all debug/overlay features OFF regardless of URL params
                var params = new URLSearchParams(window.location.search);
                var quickParam = params.get('quick');

                window.DEBUG = false;
                window.CASCADE_DEBUG = false;
                window.SHOW_FPS = false;
                // Allow QUICK_SPIN to be optionally toggled via URL
                window.QUICK_SPIN = quickParam === '1' || quickParam === 'true';

                var original = {
                    log: console.log.bind(console),
                    info: console.info.bind(console),
                    warn: console.warn.bind(console),
                    debug: console.debug.bind(console),
                    error: console.error.bind(console)
                };

                window.setDebugLogging = function (enabled) {
                    var on = !!enabled;
                    window.DEBUG = on;
                    console.log = on ? original.log : function () {};
                    console.info = on ? original.info : function () {};
                    console.warn = on ? original.warn : function () {};
                    console.debug = on ? original.debug : function () {};
                    // Never silence errors
                    console.error = original.error;
                };

                // Ensure debug logging is OFF
                window.setDebugLogging(false);
            } catch (e) {
                // If anything goes wrong, keep native console behavior
            }
        })();
    </script>
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.70.0/dist/phaser.min.js" onerror="this.onerror=null;this.src='phaser.min.js'"></script>
    <!-- Axios for HTTP requests -->
    <script src="https://cdn.jsdelivr.net/npm/axios@1.6.0/dist/axios.min.js"></script>
    <!-- Engine primitives (pure logic / RNG) -->
    <script src="src/engine/RNG.js"></script>
    <script src="src/engine/Paytable.js"></script>
    <script src="src/engine/SymbolSource.js"></script>
    <!-- Load all modules in order -->
    <script src="src/services/NetworkService.js"></script>
    <script src="src/services/SessionService.js"></script>
    <script src="src/services/WalletAPI.js"></script>
    <script src="src/services/GameAPI.js"></script>
    <script src="src/services/DeviceDetectionService.js"></script>
    <script src="src/services/GestureDetectionService.js"></script>
    <script>
      // Initialize default symbol source (uses GameConfig via Paytable + RNG)
      (function(){
        try {
          var params = new URLSearchParams(window.location.search);
          var seed = params.get('seed') || undefined;
          var rng = new window.RNG(seed);
          window.__symbolSource = new window.SymbolSource(rng);
        } catch (e) {}
      })();
    </script>
    <script src="src/config/GameConfig.js"></script>
    <script src="src/core/GameStateManager.js"></script>
    <script src="src/core/Symbol.js"></script>
    <script src="src/systems/GridManager.js"></script>
    <script src="src/systems/WinCalculator.js"></script>
    <!-- Removed legacy UIManager include to avoid confusion/duplication. Canonical UI is src/managers/UIManager.js. -->
    <script src="src/managers/AnimationManager.js"></script>
    <script src="src/managers/UIManager.js"></script>
    <script src="src/managers/BurstModeManager.js"></script>
    <script src="src/managers/WinPresentationManager.js"></script>
    <script src="src/managers/FreeSpinsManager.js"></script>
    <script src="src/managers/BonusManager.js"></script>
    <script src="src/managers/OrientationManager.js"></script>
    <script src="src/controllers/OverlayController.js"></script>
    <script src="src/shaders/RedLightningShader.js"></script>
    <script src="src/shaders/ThanosPowerGripShader.js"></script>
    <script src="src/shaders/FireShader.js"></script>
    <script src="src/shaders/BlackholeShader.js"></script>
    <script src="src/shaders/LightningCircleExplosion.js"></script>
    <script src="src/effects/ThanosPowerGripEffect.js"></script>
    <script src="src/effects/FireEffect.js"></script>
    <script src="src/scenes/LoadingScene.js"></script>
    <script src="src/scenes/LoginScene.js"></script>
    <script src="src/scenes/MenuScene.js"></script>
    <script src="src/scenes/GameScene.js"></script>
    <script src="src/main.js"></script>
    <!-- Optional RTP simulator overlay: enable with ?rtp=50000 -->
    <script src="src/tools/MathSimulator.js"></script>
</body>
</html> 